!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n,t){"use strict";var o,r=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},a=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),i=[];function c(e){for(var n=-1,t=0;t<i.length;t++)if(i[t].identifier===e){n=t;break}return n}function s(e,n){for(var t={},o=[],r=0;r<e.length;r++){var a=e[r],s=n.base?a[0]+n.base:a[0],l=t[s]||0,u="".concat(s," ").concat(l);t[s]=l+1;var d=c(u),f={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(i[d].references++,i[d].updater(f)):i.push({identifier:u,updater:v(f,n),references:1}),o.push(u)}return o}function l(e){var n=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var r=t.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach((function(e){n.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(n);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}return n}var u,d=(u=[],function(e,n){return u[e]=n,u.filter(Boolean).join("\n")});function f(e,n,t,o){var r=t?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(n,r);else{var a=document.createTextNode(r),i=e.childNodes;i[n]&&e.removeChild(i[n]),i.length?e.insertBefore(a,i[n]):e.appendChild(a)}}function m(e,n,t){var o=t.css,r=t.media,a=t.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var p=null,h=0;function v(e,n){var t,o,r;if(n.singleton){var a=h++;t=p||(p=l(n)),o=f.bind(null,t,a,!1),r=f.bind(null,t,a,!0)}else t=l(n),o=m.bind(null,t,n),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return o(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;o(e=n)}else r()}}e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=r());var t=s(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<t.length;o++){var r=c(t[o]);i[r].references--}for(var a=s(e,n),l=0;l<t.length;l++){var u=c(t[l]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}t=a}}}},function(e,n,t){"use strict";e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=function(e,n){var t=e[1]||"",o=e[3];if(!o)return t;if(n&&"function"==typeof btoa){var r=(i=o,c=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(c),"/*# ".concat(s," */")),a=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[t].concat(a).concat([r]).join("\n")}var i,c,s;return[t].join("\n")}(n,e);return n[2]?"@media ".concat(n[2]," {").concat(t,"}"):t})).join("")},n.i=function(e,t,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var c=0;c<e.length;c++){var s=[].concat(e[c]);o&&r[s[0]]||(t&&(s[2]?s[2]="".concat(t," and ").concat(s[2]):s[2]=t),n.push(s))}},n}},function(e,n,t){e.exports=t(7)},function(e,n,t){var o=t(0),r=t(4);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};o(r,a);e.exports=r.locals||{}},function(e,n,t){(n=t(1)(!1)).push([e.i,".container.svelte-1aoc5sc{width:100%;height:100%}canvas.svelte-1aoc5sc{width:100%;height:100%;display:block;object-fit:contain}select.svelte-1aoc5sc{position:absolute;right:20px;bottom:20px}",""]),e.exports=n},function(e,n,t){var o=t(0),r=t(6);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};o(r,a);e.exports=r.locals||{}},function(e,n,t){(n=t(1)(!1)).push([e.i,"html, body{width:100%;height:100%;background:#333;color:#eee;margin:0;padding:0;font-family:sans-serif}.start-screen.svelte-yq1gvh{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.start-button.svelte-yq1gvh{text-transform:uppercase;padding:0.5em 1em;font-size:x-large;border:none;background:#444;color:#eee;transition:background-color 0.3s ease-in-out}.start-button.svelte-yq1gvh:hover,.start-button.svelte-yq1gvh:focus{background:#555}.not-supported.svelte-yq1gvh{color:hsl(0, 100%, 80%)}",""]),e.exports=n},function(e,n,t){"use strict";t.r(n);t.p;function o(){}function r(e){return e()}function a(){return Object.create(null)}function i(e){e.forEach(r)}function c(e){return"function"==typeof e}function s(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}new Set;function l(e,n){e.appendChild(n)}function u(e,n,t){e.insertBefore(n,t||null)}function d(e){e.parentNode.removeChild(e)}function f(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function p(){return m(" ")}function h(e,n,t,o){return e.addEventListener(n,t,o),()=>e.removeEventListener(n,t,o)}function v(e,n,t){null==t?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function g(e,n){for(let t=0;t<e.options.length;t+=1){const o=e.options[t];if(o.__value===n)return void(o.selected=!0)}}function b(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}new Set;let y;function _(e){y=e}function x(){if(!y)throw new Error("Function called outside component initialization");return y}const z=[],w=[],T=[],E=[],$=Promise.resolve();let C=!1;function R(){C||(C=!0,$.then(O))}function S(e){T.push(e)}let L=!1;const A=new Set;function O(){if(!L){L=!0;do{for(let e=0;e<z.length;e+=1){const n=z[e];_(n),U(n.$$)}for(z.length=0;w.length;)w.pop()();for(let e=0;e<T.length;e+=1){const n=T[e];A.has(n)||(A.add(n),n())}T.length=0}while(z.length);for(;E.length;)E.pop()();C=!1,L=!1,A.clear()}}function U(e){if(null!==e.fragment){e.update(),i(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(S)}}const D=new Set;let j;function k(){j={r:0,c:[],p:j}}function M(){j.r||i(j.c),j=j.p}function P(e,n){e&&e.i&&(D.delete(e),e.i(n))}function X(e,n,t,o){if(e&&e.o){if(D.has(e))return;D.add(e),j.c.push(()=>{D.delete(e),o&&(t&&e.d(1),o())}),e.o(n)}}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let B;function F(e,n,t){const{fragment:o,on_mount:a,on_destroy:s,after_update:l}=e.$$;o&&o.m(n,t),S(()=>{const n=a.map(r).filter(c);s?s.push(...n):i(n),e.$$.on_mount=[]}),l.forEach(S)}function N(e,n){const t=e.$$;null!==t.fragment&&(i(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function q(e,n,t,r,c,s,l=[-1]){const u=y;_(e);const f=n.props||{},m=e.$$={fragment:null,ctx:null,props:s,update:o,not_equal:c,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:a(),dirty:l};let p=!1;if(m.ctx=t?t(e,f,(n,t,...o)=>{const r=o.length?o[0]:t;return m.ctx&&c(m.ctx[n],m.ctx[n]=r)&&(m.bound[n]&&m.bound[n](r),p&&function(e,n){-1===e.$$.dirty[0]&&(z.push(e),R(),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}(e,n)),t}):[],m.update(),p=!0,i(m.before_update),m.fragment=!!r&&r(m.ctx),n.target){if(n.hydrate){const e=(h=n.target,Array.from(h.childNodes));m.fragment&&m.fragment.l(e),e.forEach(d)}else m.fragment&&m.fragment.c();n.intro&&P(e.$$.fragment),F(e,n.target,n.anchor),O()}var h;_(u)}"function"==typeof HTMLElement&&(B=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,n,t){this[e]=t}$destroy(){N(this,1),this.$destroy=o}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}});class G{$destroy(){N(this,1),this.$destroy=o}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}}const I={protan:{x:.7465,y:.2535,m:1.273463,yi:-.073894},deutan:{x:1.4,y:-.4,m:.968437,yi:.003331},tritan:{x:.1748,y:0,m:.062921,yi:.292119}},Y={deuteranomaly:{name:"Deuteranomaly",blinder:I.deutan,anomalize:!0,achroma:!1,stats:"6% of males, 0.4% of females",description:"green-weakness"},deuteranopia:{name:"Deuteranopia",blinder:I.deutan,anomalize:!1,achroma:!1,stats:"1% of males",description:"green-blindness"},protanomaly:{name:"Protanomaly",blinder:I.protan,anomalize:!0,achroma:!1,stats:"1% of males, 0.01% of females",description:"red-weakness"},protanopia:{name:"Protanopia",blinder:I.protan,anomalize:!1,achroma:!1,stats:"1% of males",description:"red-blindness"},tritanomaly:{name:"Tritanomaly",blinder:I.tritan,anomalize:!0,achroma:!1,stats:"0.01% of males and females",description:"blue-weakness"},tritanopia:{name:"Tritanopia",blinder:I.tritan,anomalize:!1,achroma:!1,stats:"1% of males and females",description:"blue-blindness"},achromatomaly:{name:"Achromatomaly",blinder:void 0,anomalize:!0,achroma:!1,stats:"very rare",description:"blue cone monochromacy"},achromatopsia:{name:"Achromatopsia",blinder:void 0,anomalize:!1,achroma:!0,stats:"0.0033% of males and females",description:"monochromacy"}};function H(e,n,t){const o=e.createShader(n);if(null==o)throw new Error("Counld not create shader of type "+n);if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("An error occurred compiling the shaders: "+e.getShaderInfoLog(o));return o}class W{constructor(e,n){this.texcoordBuffer=null,this.initCanvas(e),this.bindSource(n)}getCanvas(){return this.canvas}initCanvas(e){const n=e.getContext("webgl");if(!n)throw new Error("Could not initialize WebGL context!");const t=n.createProgram();if(!t)throw new Error("Could not create WebGL program!");const o=H(n,n.FRAGMENT_SHADER,"precision mediump float;\n\n// our texture\nuniform sampler2D u_image;\n\nuniform vec4 u_blinderLine;\nuniform bool u_anomalize;\nuniform bool u_achroma;\nuniform bool u_enabled;\n\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texCoord;\n\nvec3 convertRgbToXyz(vec3 o) {\n  vec3 z = o;\n\n  mat3 matrixRgbXyz = mat3(\n    0.41242371206635076, 0.3575793401363035, 0.1804662232369621,\n    0.21265606784927693, 0.715157818248362, 0.0721864539171564,\n    0.019331987577444885, 0.11919267420354762, 0.9504491124870351\n  );\n\n  z.r = z.r > 0.04045 ? pow(((z.r + 0.055) / 1.055), 2.4) : z.r / 12.92;\n  z.g = z.g > 0.04045 ? pow(((z.g + 0.055) / 1.055), 2.4) : z.g / 12.92;\n  z.b = z.b > 0.04045 ? pow(((z.b + 0.055) / 1.055), 2.4) : z.b / 12.92;\n\n  return z * matrixRgbXyz;\n}\n\nvec3 convertXyzToXyY(vec3 o) {\n  float n = o.x + o.y + o.z;\n\n  if (n == 0.0) {\n    // prevent division by zero\n    return vec3(0, 0, o.y);\n  }\n\n  return vec3(o.x / n, o.y / n, o.y);\n}\n\nvec3 anomalize(vec3 z, vec3 rgb) {\n  float v = 1.75;\n  float n = v + 1.0;\n  return (v * z + rgb) / n;\n}\n\nvec3 applyGammaCorrection(vec3 rgb) {\n  // apply gamma and clamp simulated color...\n  float gammaCorrection = 2.2; // TODO make param\n  return vec3(\n    pow(rgb.r, 1.0 / gammaCorrection),\n    pow(rgb.g, 1.0 / gammaCorrection),\n    pow(rgb.b, 1.0 / gammaCorrection)\n  );\n}\n\nvec3 applyAchroma(vec3 rgb) {\n  float z = rgb.r * 0.212656 + rgb.g * 0.715158 + rgb.b * 0.072186;\n\n  if (!u_anomalize) {\n    // overexpose to simulate high light sensitivity to achromatopsia\n    float exposure = 2.0; // make param?\n    z *= exposure;\n  }\n\n  return vec3(z, z, z);\n}\n\nvec3 applyBlinder(vec3 rgb) {\n  vec3 c = convertXyzToXyY(convertRgbToXyz(rgb)); // (x, y, Y)\n\n  // The confusion line is between the source color and the confusion point\n  float slope = (c.y - u_blinderLine.y) / (c.x - u_blinderLine.x);\n  float yi = c.y - c.x * slope; // slope, and y-intercept (at x=0)\n\n  // Find the change in the x and y dimensions (no Y change)\n  float dx = (u_blinderLine.w - yi) / (slope - u_blinderLine.z);\n  float dy = (slope * dx) + yi;\n\n  // Find the simulated color's XYZ coords\n  vec3 z = vec3(\n    dx * c.z / dy,\n    c.z,\n    (1.0 - (dx + dy)) * c.z / dy\n  );\n\n  // Calculate difference between sim color and neutral color\n  float ngx = 0.312713 * c.z / 0.329016; // find neutral grey using D65 white-point\n  float ngz = 0.358271 * c.z / 0.329016;\n  vec3 d = vec3(\n    ngx - z.x,\n    0.0,\n    ngz - z.z\n  );\n\n    // find out how much to shift sim color toward neutral to fit in RGB space\n  mat3 matrixXyzRgb = mat3(\n    3.240712470389558, -1.5372626602963142, -0.49857440415943116,\n    -0.969259258688888,  1.875996969313966, 0.041556132211625726,\n    0.05563600315398933, -0.2039948802843549, 1.0570636917433989\n  );\n\n  d = d * matrixXyzRgb;\n  z = z * matrixXyzRgb;\n\n  float _r = ((z.r < 0.0 ? 0.0 : 1.0) - z.r) / d.r;\n  float _g = ((z.g < 0.0 ? 0.0 : 1.0) - z.g) / d.g;\n  float _b = ((z.b < 0.0 ? 0.0 : 1.0) - z.b) / d.b;\n  _r = (_r > 1.0 || _r < 0.0) ? 0.0 : _r;\n  _g = (_g > 1.0 || _g < 0.0) ? 0.0 : _g;\n  _b = (_b > 1.0 || _b < 0.0) ? 0.0 : _b;\n\n  float adjust = max(_r, max(_g, _b));\n\n  // shift proportionally...\n  z = z + adjust * d;\n\n  return applyGammaCorrection(z);\n}\n\nvoid main() {\n  vec4 rgba = texture2D(u_image, v_texCoord).rgba;\n  vec3 rgb = rgba.rgb;\n  vec3 z = rgb;\n\n  if (u_enabled) {\n    if (u_achroma) {\n      z = applyAchroma(rgb);\n    } else {\n      z = applyBlinder(rgb);\n    }\n\n    if (u_anomalize) {\n      z = anomalize(z, rgb);\n    }\n  }\n\n  gl_FragColor = vec4(z.r, z.g, z.b, rgba.a);\n}\n"),r=H(n,n.VERTEX_SHADER,"attribute vec2 a_texCoord;\nuniform vec2 u_resolution;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    // convert the rectangle from pixels to 0.0 to 1.0\n    vec2 zeroToOne = a_texCoord;\n\n    // convert from 0->1 to 0->2\n    vec2 zeroToTwo = zeroToOne * 2.0;\n\n    // convert from 0->2 to -1->+1 (clipspace)\n    vec2 clipSpace = zeroToTwo - 1.0;\n\n    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\n    // pass the texCoord to the fragment shader\n    // The GPU will interpolate this value between points.\n    v_texCoord = a_texCoord;\n}\n");n.attachShader(t,r),n.attachShader(t,o),n.linkProgram(t),this.texcoordLocation=n.getAttribLocation(t,"a_texCoord"),this.resolutionLocation=n.getUniformLocation(t,"u_resolution"),this.lineLocation=n.getUniformLocation(t,"u_blinderLine"),this.anomLocation=n.getUniformLocation(t,"u_anomalize"),this.achromaLocation=n.getUniformLocation(t,"u_achroma"),this.enabledLocation=n.getUniformLocation(t,"u_enabled"),this.canvas=e,this.gl=n,this.program=t}bindSource(e){this.canvas;const n=this.gl,t=this.texcoordBuffer=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),n.STATIC_DRAW);const o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),this.video=e}render(e,n=!0){const t=this.gl,o=this.program,r=this.video;if(!r)return;t.canvas.width=r.videoWidth,t.canvas.height=r.videoHeight,t.viewport(0,0,t.canvas.width,t.canvas.height),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(o),t.enableVertexAttribArray(this.texcoordLocation),t.bindBuffer(t.ARRAY_BUFFER,this.texcoordBuffer),t.vertexAttribPointer(this.texcoordLocation,2,t.FLOAT,!1,0,0),t.uniform2f(this.resolutionLocation,t.canvas.width,t.canvas.height);const a=Y[e];a.blinder&&t.uniform4fv(this.lineLocation,Object.values(a.blinder)),t.uniform1i(this.anomLocation,+a.anomalize),t.uniform1i(this.achromaLocation,+a.achroma),t.uniform1i(this.enabledLocation,+n),t.drawArrays(t.TRIANGLES,0,6)}}t(3);function J(e,n,t){const o=e.slice();return o[8]=n[t],o}function V(e){let n,t,r;return{c(){n=f("option"),n.__value=t=e[8].value,n.value=n.__value,v(n,"label",r=e[8].label)},m(e,t){u(e,n,t)},p:o,d(e){e&&d(n)}}}function Z(e){let n,t,r,a,i,c,s=e[2],m=[];for(let n=0;n<s.length;n+=1)m[n]=V(J(e,s,n));return{c(){n=f("div"),t=f("canvas"),r=p(),a=f("select");for(let e=0;e<m.length;e+=1)m[e].c();v(t,"class","svelte-1aoc5sc"),v(n,"class","container svelte-1aoc5sc"),v(a,"class","svelte-1aoc5sc"),void 0===e[0]&&S(()=>e[7].call(a))},m(o,s){u(o,n,s),l(n,t),e[6](t),u(o,r,s),u(o,a,s);for(let e=0;e<m.length;e+=1)m[e].m(a,null);g(a,e[0]),i||(c=h(a,"change",e[7]),i=!0)},p(e,[n]){if(4&n){let t;for(s=e[2],t=0;t<s.length;t+=1){const o=J(e,s,t);m[t]?m[t].p(o,n):(m[t]=V(o),m[t].c(),m[t].m(a,null))}for(;t<m.length;t+=1)m[t].d(1);m.length=s.length}5&n&&g(a,e[0])},i:o,o:o,d(t){t&&d(n),e[6](null),t&&d(r),t&&d(a),function(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}(m,t),i=!1,c()}}}function K(e,n,t){let{stream:o}=n,{mode:r}=n;const a=function(){const e=x();return(n,t)=>{const o=e.$$.callbacks[n];if(o){const r=b(n,t);o.slice().forEach(n=>{n.call(e,r)})}}}();let i,c=Object.keys(Y).sort().map(e=>({value:e,label:Y[e].name}));var s;async function l(){const e=document.createElement("video");e.srcObject=o,await e.play();const n=new W(i,e);n.bindSource(e);const t=()=>{0!=o.active?(n.render(r),requestAnimationFrame(t)):a("stop")};t()}return s=l,x().$$.on_mount.push(s),e.$set=e=>{"stream"in e&&t(3,o=e.stream),"mode"in e&&t(0,r=e.mode)},[r,i,c,o,a,l,function(e){w[e?"unshift":"push"](()=>{t(1,i=e)})},function(){r=function(e){const n=e.querySelector(":checked")||e.options[0];return n&&n.__value}(this),t(0,r),t(2,c)}]}var Q=class extends G{constructor(e){super(),q(this,e,K,Z,s,{stream:3,mode:0})}};t(5);function ee(e){let n,t,r;let a=function(e,n){return e[2]?oe:te}(e)(e);return{c(){n=f("div"),t=f("h1"),t.textContent="Color Blindness Simulator",r=p(),a.c(),v(n,"class","start-screen svelte-yq1gvh")},m(e,o){u(e,n,o),l(n,t),l(n,r),a.m(n,null)},p(e,n){a.p(e,n)},i:o,o:o,d(e){e&&d(n),a.d()}}}function ne(e){let n,t;function o(n){e[5].call(null,n)}let r={stream:e[1]};void 0!==e[0]&&(r.mode=e[0]);const a=new Q({props:r});return w.push(()=>function(e,n,t){const o=e.$$.props[n];void 0!==o&&(e.$$.bound[o]=t,t(e.$$.ctx[o]))}(a,"mode",o)),a.$on("stop",e[6]),{c(){var e;(e=a.$$.fragment)&&e.c()},m(e,n){F(a,e,n),t=!0},p(e,t){const o={};var r;2&t&&(o.stream=e[1]),!n&&1&t&&(n=!0,o.mode=e[0],r=()=>n=!1,E.push(r)),a.$set(o)},i(e){t||(P(a.$$.fragment,e),t=!0)},o(e){X(a.$$.fragment,e),t=!1},d(e){N(a,e)}}}function te(e){let n;return{c(){n=f("span"),n.textContent="Screen capture is not supported by your browser.",v(n,"class","not-supported svelte-yq1gvh")},m(e,t){u(e,n,t)},p:o,d(e){e&&d(n)}}}function oe(e){let n,t,r;return{c(){n=f("button"),n.textContent="Start",v(n,"type","button"),v(n,"class","start-button svelte-yq1gvh")},m(o,a){u(o,n,a),t||(r=h(n,"click",e[3]),t=!0)},p:o,d(e){e&&d(n),t=!1,r()}}}function re(e){let n,t,o,r;const a=[ne,ee],i=[];function c(e,n){return null!=e[1]?0:1}return n=c(e),t=i[n]=a[n](e),{c(){t.c(),o=m("")},m(e,t){i[n].m(e,t),u(e,o,t),r=!0},p(e,[r]){let s=n;n=c(e),n===s?i[n].p(e,r):(k(),X(i[s],1,1,()=>{i[s]=null}),M(),t=i[n],t||(t=i[n]=a[n](e),t.c()),P(t,1),t.m(o.parentNode,o))},i(e){r||(P(t),r=!0)},o(e){X(t),r=!1},d(e){i[n].d(e),e&&d(o)}}}function ae(e,n,t){const o="mediaDevices"in navigator&&"getDisplayMedia"in navigator.mediaDevices;let r="deuteranopia",a=null;return[r,a,o,async function(){t(1,a=await navigator.mediaDevices.getDisplayMedia())},void 0,function(e){r=e,t(0,r)},()=>t(1,a=null)]}new class extends G{constructor(e){super(),q(this,e,ae,re,s,{})}}({target:document.body})}]);